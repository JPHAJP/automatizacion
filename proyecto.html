<!DOCTYPE html>
<html lang="es-MX"> <!-- Cambiar a español mexicano -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portafolio Redes Digitales</title>
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Simple line icons-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css"
        rel="stylesheet" />
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic"
        rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="Recursos\Archivos\styles.css">
    <!--Background color-->
    <style>
        body {
            background-color: #2f3132;
        }
    </style>
    <!-- Prism CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.css"
        rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/toolbar/prism-toolbar.min.css"
        rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/toolbar/prism-toolbar.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</head>

<body id="page-top">
    <!-- Navigation -->
    <a class="menu-toggle rounded" href="#"><i class="fas fa-bars"></i></a>
    <nav id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <li class="sidebar-brand"><a>Menu</a></li>
            <li class="sidebar-nav-item"><a href="index.html#page-top">Inicio</a></li>
            <li class="sidebar-nav-item"><a href="index.html#about">Nosotros</a></li>
            <li class="sidebar-nav-item"><a href="index.html#portfolio">Portfolio</a></li>
            <li class="sidebar-nav-item"><a href="index.html#contact">Contacto</a></li>
        </ul>
    </nav>
    <!-- Portafolio menu -->
    <header class="bg-dark py-5">
        <div class="container px-4 px-lg-5 my-5">
            <div class="text-center text-white">
                <h1 class="display-4 fw-bolder">Proyecto Final</h1>
                <p class="lead fw-normal text-white-50 mb-0">Documentación del proyecto final</p>
                <a class="btn btn-primary btn-xl" href="index.html#portfolio">Regresar a Portafolio</a>
            </div>
        </div>
    </header>
    <!--Info-->
    <section class="py-5 text-white">
        <div class="container px-4 px-lg-5 my-5">
            <h3 class="text-secondary mb-0">Descripción</h3>
            <div class="row gx-4 gx-lg-5">
                <div class="col-lg-6">
                    <p>El proyecto trató del desarrollo de un sistema de monitoreo para domótica, en donde se muestran
                        datos de diferentes sensores conectados a internet mediante el NodeMCU ESP32; los cuales se
                        reflejan en un dashboard alojado en Render. <br><br>A continuación se muestra la presentación
                        del proyecto y su documentación.</p>
                </div>
                <div class="col-lg-6">
                    <img class="img-fluid" width="70%" height="auto" src="https://i.pinimg.com/originals/96/48/42/9648427c80d8994269fc176a78cdaa0b.png" alt="...">
                </div>
            </div>
        </div>
    </section>
    <!-- Events Section -->
    <section class="page-section" style="margin-left: 5%; margin-right: 5%;">
            <div style="position: relative; width: 100%; height: 0; padding-top: 56.2500%;
            padding-bottom: 0; box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden;
            border-radius: 8px; will-change: transform;">
             <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
               src="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAGIigxCCZc&#x2F;k4alG25ub1umy83Uvc64qA&#x2F;view?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
             </iframe>
           </div>
        
        <!--Render-->
        <img src="https://dka575ofm4ao0.cloudfront.net/pages-transactional_logos/retina/89884/render-status-4b015255-e0cc-422c-943d-4f60b5f03094.png" alt="Render Logo" style="width:60%; margin-left: 20%; margin-top: 100px; filter: invert(1);">
        <embed src="https://proyecto-redes.onrender.com/" type="application/pdf" width="100%" height="800px" style="margin-top: 10px;"/>
        <embed src="https://proyecto-redes.onrender.com/dashboard/" type="application/pdf" width="100%" height="800px" style="margin-top: 10px;"/>
        <a class="btn btn-primary btn-xl" style="width: 100%; margin-top: 10px;" href="https://proyecto-redes.onrender.com/">Ir al Dashboard en Render</a>
        <a class="btn btn-primary btn-xl" style="width: 100%; margin-top: 10px;" href="https://github.com/JPHAJP/Proyecto_Redes">Github del proyecto</a>
        <!--Flutterflow-->
        <img src="https://miro.medium.com/v2/resize:fit:1155/1*czqOMYaaNDhd6RTi4VtsuQ.png" alt="Flutterflow Logo" style="width:60%; margin-left: 20%; margin-top: 100px;">
        <embed src="https://preview.flutterflow.app/dashboard-icj4uf/2e7smUXqN7uLpZC81HeD" width="100%"
            height="800px" style="margin-top: 50px;"/>
        <a class="btn btn-primary btn-xl" style="width: 100%;" href="https://preview.flutterflow.app/dashboard-icj4uf/2e7smUXqN7uLpZC81HeD">Ir a WebApp</a>
        
    </section>
    <!-- Code Section -->
    <section class="py-5 text-white">
        <div class="container px-4 px-lg-5 my-5">
            <div class="code-container">
            <div>
            <h3 class="text-secondary mb-0">Timer</h3>
            </div>
            <div>
                <video width="100%" height="auto" src="Reportes/Proyecto/Time.mp4" controls></video>
            </div>
            <embed src="https://wokwi.com/projects/402186230469357569" width="100%" height="500px" />
                <div class="code-section">
                    <h3 class="text-secondary mb-0">Código Timer</h3>
                    <pre class="line-numbers"><code class="language-clike">//José Pablo Hernández Alonso
#include &ltWiFi.h>
#include &ltHTTPClient.h>
#include &ltWire.h>
#include &ltAdafruit_GFX.h>
#include &ltAdafruit_SSD1306.h>

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define BUZZER_PIN 23

Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, -1);

const int buttonIncreasePin = 27;
const int buttonDecreasePin = 26;
const int buttonModePin = 25;
const int buttonStartStopPin = 33;

volatile bool increaseFlag = false;
volatile bool decreaseFlag = false;
volatile bool modeFlag = false;
volatile bool startStopFlag = false;

volatile bool timerRunning = false;
volatile int seconds = 0;
volatile int minutes = 0;
volatile int hours = 0;
volatile int mode = 0; // 0 = seconds, 1 = minutes, 2 = hours
volatile bool buzzerActive = false;
unsigned long buzzerEndTime = 0;

const char* ssid = "EXAMPLE";  // SSID
const char* password = "EXAMPLE";  // Contraseña
const char* serverUrl = "https://proyecto-redes.onrender.com/dashboard/?apikey=123";

void setup() {
    Serial.begin(115200);
    pinMode(buttonIncreasePin, INPUT_PULLUP);
    pinMode(buttonDecreasePin, INPUT_PULLUP);
    pinMode(buttonModePin, INPUT_PULLUP);
    pinMode(buttonStartStopPin, INPUT_PULLUP);
    pinMode(BUZZER_PIN, OUTPUT);

    if (!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) {
    Serial.println(F("SSD1306 allocation failed"));
    for(;;);
    }
    display.display();
    delay(2000);
    display.clearDisplay();

    attachInterrupt(digitalPinToInterrupt(buttonIncreasePin), []() { increaseFlag = true; }, FALLING);
    attachInterrupt(digitalPinToInterrupt(buttonDecreasePin), []() { decreaseFlag = true; }, FALLING);
    attachInterrupt(digitalPinToInterrupt(buttonModePin), []() { modeFlag = true; }, FALLING);
    attachInterrupt(digitalPinToInterrupt(buttonStartStopPin), []() { startStopFlag = true; }, FALLING);

    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
    printWifi(false);
    }
    Serial.println("WiFi connected");
    printWifi(true);
}

void loop() {
    if (increaseFlag) {
    buzzerActive = false;
    handleIncrease();
    increaseFlag = false;
    }
    if (decreaseFlag) {
    buzzerActive = false;
    handleDecrease();
    decreaseFlag = false;
    }
    if (modeFlag) {
    handleMode();
    modeFlag = false;
    }
    if (startStopFlag) {
    handleStartStop();
    startStopFlag = false;
    sendDataToServer(); // Send data whenever the start/stop button is pressed
    }

    if (timerRunning) {
    delay(1000); // Wait for one second
    decrementTime();
    }
    if (buzzerActive && millis() &lt buzzerEndTime) {
    beepBuzzer(1000, 500); // 1000 Hz, beep for 500 ms
    } else if (millis() >= buzzerEndTime && buzzerActive) {
    buzzerActive = false; // Stop the buzzer after 30 seconds
    }
}

void handleIncrease() {
    if (mode == 0) { // Seconds
    if (seconds &lt 59) seconds++;
    else { seconds = 0; minutes++; }
    } else if (mode == 1) { // Minutes
    if (minutes &lt 59) minutes++;
    else { minutes = 0; hours++; }
    } else { // Hours
    hours++;
    }
    printTime();
}

void handleDecrease() {
    if (mode == 0) { // Seconds
    if (seconds > 0) seconds--;
    else { seconds = 59; if (minutes > 0) minutes--; }
    } else if (mode == 1) { // Minutes
    if (minutes > 0) minutes--;
    else { minutes = 59; if (hours > 0) hours--; }
    } else { // Hours
    if (hours > 0) hours--;
    }
    printTime();
}

void handleMode() {
    mode = (mode + 1) % 3;
    display.println("Mode changed to: " + String(mode == 0 ? "Seconds" : (mode == 1 ? "Minutes" : "Hours")));
    delay(1000);
    printTime();
}

void handleStartStop() {
    timerRunning = !timerRunning;
    display.println("Timer " + String(timerRunning ? "started" : "stopped"));
    delay(1000);
    printTime();
}

void decrementTime() {
    if (seconds > 0) {
    seconds--;
    } else if (minutes > 0) {
    minutes--;
    seconds = 59;
    } else if (hours > 0) {
    hours--;
    minutes = 59;
    seconds = 59;
    } else {
    timerRunning = false;
    buzzerActive = true; // Activate buzzer when countdown reaches 0
    buzzerEndTime = millis() + 10000; // Set the buzzer to sound for 30 seconds
    sendDataToServer();
    }
    printTime();
}

void printTime() {
    display.clearDisplay();
    display.setTextSize(2);
    display.setTextColor(WHITE);
    display.setCursor(0,0);
    display.printf("%02d:%02d:%02d\n", hours, minutes, seconds);
    display.setCursor(0,20);
    display.setTextSize(1);
    if (timerRunning) {
    display.println("Status: Running");
    } else {
    display.println("Status: Stopped");
    }
    display.display();
}

void printWifi(bool stad) {
    display.clearDisplay();
    display.setTextSize(2);
    display.setTextColor(WHITE);
    display.setCursor(0,0);
    if (stad) {
    display.println("Wifi: ON");
    } else {
    display.println("Wifi: NOT FOUND");
    }
    
    display.display();
}

void beepBuzzer(int frequency, int duration) {
    tone(BUZZER_PIN, frequency, duration);
    delay(duration);
    noTone(BUZZER_PIN);
    delay(duration);
}

void sendDataToServer() {
    if (WiFi.status() == WL_CONNECTED) {
    HTTPClient http;

    String timeString = formatTime(hours) + ":" + formatTime(minutes) + ":" + formatTime(seconds);
    String url = String(serverUrl) 
                    + "&status=" + String(timerRunning ? 0 : (buzzerActive ? 2 : 1))
                    + "&time=" + timeString;
    http.begin(url);
    Serial.println("URL: " + url);
    int httpResponseCode = http.GET();
    http.end();
    }
}

String formatTime(int timeValue) {
    if (timeValue &lt 10) {
    return "0" + String(timeValue); // Añade un cero si el número es menor de 10
    } else {
    return String(timeValue); // Usa el número tal cual si no es menor de 10
    }
}</code></pre>
                </div>
                <div style="display: block; width: 100%;">
                    <h3 class="text-secondary mb-0">Proximidad</h3>
                </div>
                    <video style="display: block; width: 80%; margin-left: 10%;" width="80%" height="auto" src="Reportes/Proyecto/Prox.mp4" controls></video>
                
                <embed src="https://wokwi.com/projects/402812020563856385" width="100%" height="500px" />
                <div class="code-section">
                    <h3 class="text-secondary mb-0">Código Proximidad</h3>
                    <pre class="line-numbers"><code class="language-clike">//Dirk Anton Topcic Martinez
#include &ltNewPing.h>
#include &ltWiFi.h>
#include &ltHTTPClient.h>

#define PIN_TRIG 26
#define PIN_ECHO 27

int ledV  = 32;
int ledA = 33;
int ledR = 25;

//PHP server
String url = "https://proyecto-redes.onrender.com/dashboard/?apikey=123&";
String sensor= "dist";


void setup(){
    pinMode(ledV, OUTPUT);
    pinMode(ledA, OUTPUT);
    pinMode(ledR, OUTPUT);

    pinMode(PIN_TRIG, OUTPUT);
    pinMode(PIN_ECHO, INPUT);

    delay(1000);
    Serial.begin(115200);

    WiFi.begin("Jp Phone", "yayoyayo");

    while((WiFi.status() != WL_CONNECTED)) {
        delay(500);
        Serial.print(".");
    }
        Serial.println("Wifi conected");
}

void loop(){
    delay(1000);
    digitalWrite(PIN_TRIG, HIGH);
    delayMicroseconds(10);
    digitalWrite(PIN_TRIG, LOW);

    long duration = pulseIn(PIN_ECHO, HIGH);
    int distance = duration / 58;
    Serial.print("Distance in: ");
    Serial.println(distance);
    
    if (distance > 7) {
    digitalWrite(ledV, HIGH);
    digitalWrite(ledA, LOW);
    digitalWrite(ledR, LOW);
    } else if (distance <= 7 && distance > 2) {
    digitalWrite(ledV, LOW);
    digitalWrite(ledA, HIGH);
    digitalWrite(ledR, LOW);
    } else if (distance <= 2) {
    digitalWrite(ledV, LOW);
    digitalWrite(ledA, LOW);
    digitalWrite(ledR, HIGH);
    } else {
    digitalWrite(ledV, LOW);
    digitalWrite(ledA, LOW);
    digitalWrite(ledR, LOW);
    }
    if((WiFi.status() == WL_CONNECTED)) {
    HTTPClient http;
    String message=url+sensor+"="+String(distance);
    http.begin(message);

    int httpCode = http.GET();
    Serial.println(message);
    Serial.print("Get code");
    Serial.println(httpCode);
    http.end();
    }
    delay (3000);
}</code></pre>
                </div>
                <h3 style="display: block; width: 100%;" class="text-secondary mb-0">Humedad</h3>
                <div>
                    <video style="display: block; width: 80%; margin-left: 90%;" width="80%" height="auto" src="Reportes/Proyecto/Hum.mp4" controls></video>
                </div>
                <embed src="https://wokwi.com/projects/402812383601885185" width="100%" height="500px" />
                <div class="code-section">
                    <h3 class="text-secondary mb-0">Código Humedad</h3>
                    <pre class="line-numbers"><code class="language-clike">//Máximo Arenas Roa
#include &ltDHT.h>
#include &ltWiFi.h>
#include &ltHTTPClient.h>

//int led=32;
String url="https://proyecto-redes.onrender.com/dashboard/?";
String apikey="123";
String sensor="hum";

DHT dht (15, DHT22);

int valor_temperatura=0; 
int valor_humedad=0;
void setup() {
    //pinMode (led, OUTPUT);// Configurar puerto 2 como salida 
    dht.begin();//Inicializamos DHT
    Serial.begin (115200);
    //Conect to wifi network
    WiFi.begin("EXAMPLE", "EXAMPLE"); //WiFi_Network, Wifi_Password
    //Wait until connection
    while((WiFi.status() != WL_CONNECTED)){
    delay(500);
    Serial.print(".");
    }
    Serial.println("Wifi conected");
}

void loop(){
    delay (1000);
    valor_temperatura=dht.readTemperature();
    valor_humedad=dht.readHumidity();
    Serial.print ("Temperatura:");
    Serial.println(valor_temperatura);
    Serial.print ("Humedad:");
    Serial.println(valor_humedad);

    if(valor_humedad>=50){//Si la temperatura es mayor a 50%
    //digitalWrite(led,HIGH);
//Wait for WIFI connection
    if((WiFi.status() == WL_CONNECTED)){
        //Start connection and send HTTP header, return error code
        HTTPClient http;
        //String message= url+"apikey="+apikey+"&"+sensor+"="+ String(valor_temperatura) + "&field2=" + String(valor_humedad);
        String message= url+"apikey="+apikey+"&"+sensor+"="+String(valor_humedad);
        http.begin(message); //HTTP
        int httpCode = http.GET();
        Serial.println(message);
        Serial.print("GET code:");
        Serial.println(httpCode);
        http.end();
    }
    delay(3000);
    }
}</code></pre>
                </div>
                <h3 style="display: block; width: 100%;"class="text-secondary mb-0">Presencia</h3>
                <div>
                    <video style="display: block; width: 100%; margin-left: 90%;"width="100%" height="auto" src="Reportes/Proyecto/Movimiento.mp4" controls></video>
                </div>
                <embed src="https://wokwi.com/projects/402813005422218241" width="100%" height="500px" />
                <div class="code-section">
                    <h3 class="text-secondary mb-0">Código Presencia</h3>
                    <pre class="line-numbers"><code class="language-clike">//Mary Tere Füguemann Sardá
#include &ltWiFi.h>
#include &ltHTTPClient.h>
// Definimos los pines
int pirPin = 33;
int ledPin = 32;
String url = "https://proyecto-redes.onrender.com/dashboard/?";
String apikey = "123";
String sensor = "mov";
void setup() {
    pinMode(pirPin, INPUT); // Configurar puerto 33 como entrada para el sensor PIR
    pinMode(ledPin, OUTPUT); // Configurar puerto 32 como salida para el LED
    Serial.begin(115200);

    // Conectar a la red WiFi
    WiFi.begin("EXAMPLE", "EXAMPLE"); // WiFi_Network, Wifi_Password

    // Esperar hasta que se conecte
    while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
    }
    Serial.println("WiFi conectado");
}

void loop() {
    int pirValue = digitalRead(pirPin); // Leer el valor del sensor PIR

    if (pirValue == HIGH) { // Si detecta movimiento
    digitalWrite(ledPin, HIGH); // Encender el LED

    // Esperar conexión WiFi
    if (WiFi.status() == WL_CONNECTED) {
        // Iniciar conexión y enviar encabezado HTTP
        HTTPClient http;
        String message = url + "apikey=" + apikey + "&" + sensor + "=" + String(pirValue);
        http.begin(message); // HTTP

        int httpCode = http.GET();
        Serial.println(message);
        Serial.print("GET code:");
        Serial.println(httpCode);
        http.end();
    }
    } else {
    digitalWrite(ledPin, LOW); // Apagar el LED si no hay movimiento
    }
    delay(3000); // Esperar 3 segundos antes de la siguiente lectura
}</code></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer text-center">
        <div class="container px-4 px-lg-5"></div>
        <ul class="list-inline mb-5">
            <li class="list-inline-item">
                <a class="social-link rounded-circle text-white mr-3"
                    href="https://mx.linkedin.com/in/jos%C3%A9-pablo-hern%C3%A1ndez-alonso-03a195256"><i
                        class="icon-social-linkedin"></i></a>
            </li>
            <li class="list-inline-item">
                <a class="social-link rounded-circle text-white mr-3"
                    href="https://www.instagram.com/jose_pablo_ha?igsh=MTlvb2s1ejFuY210MQ%3D%3D&utm_source=qr"><i
                        class="icon-social-instagram"></i></a>
            </li>
            <li class="list-inline-item">
                <a class="social-link rounded-circle text-white" href="https://github.com/JPHAJP"><i
                        class="icon-social-github"></i></a>
            </li>
        </ul>
        <img src="Recursos/Imagenes/IM3.png" alt="University Logo" style="width:100px;">
        <p>Universidad Iberoamericana Puebla.</p>
        <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><span
                property="dct:title">Redes Digitales</span> by <span property="cc:attributionName">José Pablo Hernández
                & Dirk Anton Topcic</span> is licensed under <a
                href="https://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1" target="_blank"
                rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-ND 4.0<img
                    style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
                    src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img
                    style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
                    src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img
                    style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
                    src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img
                    style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
                    src="https://mirrors.creativecommons.org/presskit/icons/nd.svg?ref=chooser-v1" alt=""></a></p>
        </div>
    </footer>

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top"><i class="fas fa-angle-up"></i></a>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="../../../Recursos\Archivos\scripts.js"></script>
    <!-- Prism.js script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <!-- Prism.js plugin for line numbers -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <!-- Prism.js plugin for toolbar -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/toolbar/prism-toolbar.min.js"></script>
    <!-- Prism.js plugin for copy to clipboard functionality -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>